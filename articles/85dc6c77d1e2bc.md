---
title: "ÂÖ•ÈñÄ Jetpack Compose Animation part3"
emoji: "üéâ"
type: "tech" # tech: ÊäÄË°ìË®ò‰∫ã / idea: „Ç¢„Ç§„Éá„Ç¢
topics: ["android","jetpackcompose"]
published: false
---

## „ÅØ„Åò„ÇÅ„Å´

ÂâçÂõû„ÅØ„ÄÅ[Value-based animations](https://developer.android.com/develop/ui/compose/animation/value-based)„ÇíË™≠„Çì„ÅßÂ≠¶Áøí„Åó„ÅüÂÜÖÂÆπ„Çí„Åæ„Å®„ÇÅ„Åæ„Åó„Åü„ÄÇ
‰ªäÂõû„ÅØ„ÄÅ[Advanced animation example](https://developer.android.com/develop/ui/compose/animation/advanced)„ÇíË™≠„Çì„ÅßÂ≠¶Áøí„Åó„ÅüÂÜÖÂÆπ„Çí„Åæ„Å®„ÇÅ„Åæ„Åô„ÄÇ

## „Ç∏„Çß„Çπ„ÉÅ„É£„Éº„Å®„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥

„Çø„ÉÉ„ÉÅ„Ç§„Éô„É≥„Éà„Å®„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÇíÁµÑ„ÅøÂêà„Çè„Åõ„ÇãÂ†¥Âêà„ÅØÊ≥®ÊÑè„Åô„Çã„Åì„Å®„ÅåÂ¢ó„Åà„Åæ„Åô„ÄÇ
„É¶„Éº„Ç∂„Éº„Ç§„É≥„Çø„É©„ÇØ„Ç∑„Éß„É≥„ÅØ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„Çà„Çä„ÇÇÂÑ™ÂÖà„Åï„Çå„ÄÅ„Çø„ÉÉ„ÉÅ„Ç§„Éô„É≥„Éà„ÅåÈñãÂßã„Åï„Çå„Åü„Çâ„ÄÅ„Åü„Å®„Åà„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÅÆÈÄî‰∏≠„Åß„ÅÇ„Å£„Å¶„ÇÇ‰∏≠Êñ≠„Åó„Å¶Êñ∞„Åó„ÅÑ„Ç§„Éô„É≥„Éà„Å´ÂèçÂøú„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ

### „Ç∏„Çß„Çπ„ÉÅ„É£„Éº

![](/images/85dc6c77d1e2bc/GestureSample.gif)

```kotlin
@Composable
fun Gesture(modifier: Modifier = Modifier) {
    // you can use Animatable to change Offset
    val offset = remember { Animatable(Offset.Zero, Offset.VectorConverter) }
    val scope = rememberCoroutineScope()
    Box(
        modifier = modifier
            .fillMaxSize()
            .pointerInput(Unit) {
                // using high level api
                detectTapGestures {
                    scope.launch {
                        // cancel after new tap event comming
                        offset.animateTo(it)
                    }
                }

                // using low level api
                coroutineScope {
                    // cancel after new tap event comming
                    while (true) {
                        awaitPointerEventScope {
                            val position = awaitFirstDown().position
                            launch {
                                offset.animateTo(position)
                            }
                        }
                    }
                }
            }
    ) {
        Box(
            modifier = Modifier
                .offset { offset.value.toIntOffset() }
                .size(100.dp)
                .background(Color.Blue, shape = CircleShape)
        )
    }
}

private fun Offset.toIntOffset() = IntOffset(x.roundToInt(), y.roundToInt())
```

### Ëá™‰ΩúSwipeToDismiss

![](/images/85dc6c77d1e2bc/SwipeToDismissSample.gif)

```kotlin
fun Modifier.swipeToDismiss(
    onDismissed: () -> Unit
): Modifier = composed {
    val offsetX = remember { Animatable(0f) }
    pointerInput(Unit) {
        val decay = splineBasedDecay<Float>(this)
        coroutineScope {
            while (true) {
                val velocityTracker = VelocityTracker()
                // 1
                offsetX.stop()
                awaitPointerEventScope {
                    val pointerId = awaitFirstDown().id
                    horizontalDrag(pointerId) { change ->
                        launch {
                            // 2
                            offsetX.snapTo(offsetX.value + change.positionChange().x)
                        }
                        velocityTracker.addPosition(
                            change.uptimeMillis,
                            change.position,
                        )
                    }
                }
                // „Çπ„ÉØ„Ç§„Éó„ÅÆÈÄüÂ∫¶„ÇíË®àÊ∏¨
                val velocity = velocityTracker.calculateVelocity().x
                val targetOffsetX = decay.calculateTargetValue(offsetX.value, velocity)
                offsetX.updateBounds(
                    lowerBound = -size.width.toFloat(),
                    upperBound = size.width.toFloat(),
                )
                launch {
                    if (targetOffsetX.absoluteValue <= size.width) {
                        // 3
                        offsetX.animateTo(
                            targetValue = 0f,
                            initialVelocity = velocity,
                        )
                    } else {
                        // 4
                        offsetX.animateDecay(velocity, decay)
                        onDismissed()
                    }
                }
            }
        }
    }
        .offset { IntOffset(offsetX.value.roundToInt(), 0) }
}
```

1. „Çø„ÉÉ„Éó„Ç§„Éô„É≥„Éà„ÇíÊ§úÁü•„Åó„Åü„Çâ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÇíÂÅúÊ≠¢„Åó„Åæ„Åô„ÄÇ  
2. Ê∞¥Âπ≥ÊñπÂêë„ÅÆ„Éâ„É©„ÉÉ„Ç∞„Ç§„Éô„É≥„Éà„ÇíÊ§úÁü•„Åó„ÄÅ`offsetX`„ÅÆÂÄ§„ÇíÊõ¥Êñ∞„Åó„Åæ„Åô„ÄÇ
    - `snapTo`„Çí‰ΩøÁî®„Åó„Å¶„ÄÅ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„Åõ„Åö„Å´Âç≥Â∫ß„Å´‰ΩçÁΩÆ„ÇíÂ§âÊõ¥„Åó„Åæ„Åô„ÄÇ
3. Ë¶ÅÁ¥†„ÅÆ„Ç™„Éï„Çª„ÉÉ„Éà„ÅåËá™Ë∫´„ÅÆÂπÖ„ÇíË∂Ö„Åà„Å™„ÅÑÂ†¥Âêà„ÅØ„ÄÅ`animateTo`„Çí‰ΩøÁî®„Åó„Å¶ÂÖÉ„ÅÆ‰ΩçÁΩÆÔºà0Ôºâ„Å∏Êàª„Çã„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÇíÂÆüË°å„Åó„Åæ„Åô„ÄÇ
4. Ë¶ÅÁ¥†„ÅÆ„Ç™„Éï„Çª„ÉÉ„Éà„ÅåËá™Ë∫´„ÅÆÂπÖ„ÇíË∂Ö„Åà„ÅüÂ†¥Âêà„ÅØ„ÄÅ`animateDecay`„Çí‰ΩøÁî®„Åó„Å¶Ê∏õË°∞„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÇíÂÆüË°å„Åó„Å¶„ÄÅË¶ÅÁ¥†„ÇíÁîªÈù¢Â§ñ„Å´„Çπ„ÉØ„Ç§„Éó„Åó„Åæ„Åô„ÄÇ„Çπ„ÉØ„Ç§„Éó„ÅåÂÆå‰∫Ü„Åó„Åü„Çâ„ÄÅ`onDismissed`„ÇíÂëº„Å≥Âá∫„Åó„Å¶Ë¶ÅÁ¥†„ÇíÂâäÈô§„Åó„Åæ„Åô„ÄÇ

„Åì„ÅÆ„Çà„ÅÜ„Å´„ÄÅ„É¶„Éº„Ç∂„Éº„ÅÆ„Çø„ÉÉ„ÉÅÊìç‰Ωú„Å®„Åù„ÅÆÈÄüÂ∫¶„Å´Âøú„Åò„Åü„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Âà∂Âæ°„ÅåÂÆüÁèæ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ

#### ‰ΩôË´á

`offsetX.updateBounds`„ÅØ„ÄÅ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÅÆÁØÑÂõ≤„ÇíÂà∂Èôê„Åô„Çã„Åü„ÇÅ„ÅÆÈñ¢Êï∞„Åß„ÄÅ„Çπ„ÉØ„Ç§„Éó„ÅÆÂãï„Åç„ÅåÁîªÈù¢Â§ñ„Å´Âá∫„Å™„ÅÑ„Çà„ÅÜ„Å´Âà∂Âæ°„Åó„Åæ„Åô„ÄÇ
`animateDecay`„ÅØ„ÄÅ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÅÆÊ∏õË°∞„ÇíË°®Áèæ„Åô„Çã„Åü„ÇÅ„ÅÆÈñ¢Êï∞„Åß„ÄÅÁâ©ÁêÜÁöÑ„Å™Âãï„Åç„ÇÑÊÖ£ÊÄß„ÇíÊ®°ÂÄ£„Åô„Çã„ÅÆ„Å´ÂΩπÁ´ã„Å°„Åæ„Åô„ÄÇ